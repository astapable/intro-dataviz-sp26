<!DOCTYPE html>
<html>
<head>
  <title>D3.js Minimalist Clock</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    .clock-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .clock-face {
      fill: none;
      stroke: none;
      stroke-width: 2px;
    }
    .time-marker {
      fill: #4285f4;
      transition: all 0.5s ease;
    }
    .time-text {
      font-family: Arial, sans-serif;
      font-size: 22px;
      text-anchor: middle;
      dominant-baseline: middle;
    }
  </style>
</head>
<body>
  <div class="clock-container">
    <svg id="clock" width="300" height="300"></svg>
  </div>

  <script>
    // Set up the SVG container
    const svg = d3.select("#clock");
    const width = 300;
    const height = 300;
    const radius = Math.min(width, height) / 2 - 10;
    const centerX = width / 2;
    const centerY = height / 2;

    // Create the clock face
    svg.append("circle")
      .attr("cx", centerX)
      .attr("cy", centerY)
      .attr("r", radius)
      .attr("class", "clock-face");

    // Create 60 marker circles arranged around the face
    const totalMarkers = 60;
    const markersGroup = svg.append("g").attr("transform", `translate(${centerX}, ${centerY})`);

    const markersData = d3.range(totalMarkers).map(i => {
      const angle = (i / totalMarkers) * 2 * Math.PI - Math.PI / 2;
      return {
        index: i,
        angle,
        x: Math.cos(angle) * (radius * 0.8),
        y: Math.sin(angle) * (radius * 0.8)
      };
    });

    markersGroup.selectAll("circle")
      .data(markersData)
      .enter()
      .append("circle")
      .attr("class", "time-marker")
      .attr("cx", d => d.x)
      .attr("cy", d => d.y)
      .attr("r", 3)
      .attr("fill", "#4285f4");

    // Add text for displaying time
    const timeText = svg.append("text")
      .attr("x", centerX)
      .attr("y", centerY)
      .attr("class", "time-text");

    // Animate: each circle moves straight to center (0,0) and back to its position.
    // Each element starts staggered by 0.1s and has randomized duration/pause.
    markersGroup.selectAll("circle").each(function(d, i) {
      const circle = d3.select(this);
      const initialDelay = i * 100; // 0.1s stagger

      function loop(firstRun = false) {
        const dur = 300 + Math.random() * 800; // random duration
        const pause = 150 + Math.random() * 600; // random pause before repeating

        // move to center
        let t = circle.transition();
        if (firstRun) t = t.delay(initialDelay);
        t = t.duration(dur).attr("cx", 0).attr("cy", 0);

        // move back to original position
        t.transition().duration(dur).attr("cx", d.x).attr("cy", d.y).on("end", () => {
          setTimeout(() => loop(false), pause);
        });
      }

      loop(true);
    });

    // Update the digital clock text every 250ms
    d3.interval(() => {
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const seconds = now.getSeconds();
      timeText.text(`${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);
    }, 250);
  </script>
</body>
</html>
